# Makefile for uClibc
#
# Copyright (C) 2000-2005 Erik Andersen <andersen@uclibc.org>
#
# Licensed under the LGPL v2.1, see the file COPYING.LIB in this tarball.
#

CSRC:=	__longjmp.c  brk.c setjmp_aux.c mmap.c __syscall_error.c \
	cacheflush.c pread_write.c sysmips.c _test_and_set.c sigaction.c

SSRC:=bsd-_setjmp.S bsd-setjmp.S setjmp.S clone.S syscall.S pipe.S


ARCH_DIR:=$(top_srcdir)libc/sysdeps/linux/mips
ARCH_OUT:=$(top_builddir)libc/sysdeps/linux/mips

ARCH_CSRC:=$(patsubst %.c,$(ARCH_DIR)/%.c,$(CSRC))
ARCH_COBJ:=$(patsubst %.c,$(ARCH_OUT)/%.o,$(CSRC))
ARCH_SSRC:=$(patsubst %.S,$(ARCH_DIR)/%.S,$(SSRC))
ARCH_SOBJ:=$(patsubst %.S,$(ARCH_OUT)/%.o,$(SSRC))

ARCH_OBJS:=$(ARCH_COBJ) $(ARCH_SOBJ)

crt-y:=create
libc-a-y+=$(ARCH_OBJS)
libc-a-pic-y+=$(ARCH_OBJS:.o=.os)
libc-so-y+=$(ARCH_OBJS:.o=.os)

#libc-multi-y+=$(ARCH_CSRC)
libc-nomulti-y+=$(ARCH_OBJS)

objclean-y+=arch_objclean

arch_objclean:
	$(RM) $(ARCH_OUT)/*.{o,os} $(top_builddir)include/sgidefs.h

headers-y+=arch_headers

arch_headers:
	$(LN) -fs ../libc/sysdeps/linux/mips/sgidefs.h $(top_builddir)include/
#	$(LN) -fs ../libc/sysdeps/linux/mips/regdef.h $(top_builddir)include/
	$(LN) -fs ../libc/sysdeps/linux/mips/fpu_control.h $(top_builddir)include/
